import{B as K,S as X,J as Te,L as Pe,n as se,t as m,m as y,d as E,j as T,k as I,b1 as Ie,s as O,bn as ue,aq as re,bo as Ge,bp as Ce,g as Z,K as Me,f as Be,a as Re,b6 as me,ae as we,bq as _e,v as ze,x as Fe,p as ke,af as Ee,i as We,F as Oe,br as He,bs as Ye,bt as Ve,bu as ce,bv as Ne,aZ as Ue}from"./BBnRYWwF.js";import{c as Xe,a as je}from"./CSGVnLJV.js";import{r as oe,s as ve,a as Ze,t as Ke}from"./BtaKLMN8.js";import{d as he}from"./DKB9rCL-.js";const $e="Lines",qe={name:$e,defaultParams:Te,layerIndex:Pe,validator:(r,{validateColumns:n})=>n(r,{lineCurve:{toBeTypes:["string"]},lineWidth:{toBeTypes:["number"]}})},Ft=K(qe)(({selection:r,rootSelection:n,name:t,observer:e,subject:i})=>{const o=new X,b=Xe($e,{selection:r,computedData$:e.computedData$,computedAxesData$:e.computedAxesData$,visibleComputedData$:e.visibleComputedData$,visibleComputedAxesData$:e.visibleComputedAxesData$,seriesLabels$:e.seriesLabels$,SeriesDataMap$:e.SeriesDataMap$,GroupDataMap$:e.GroupDataMap$,fullParams$:e.fullParams$,fullDataFormatter$:e.fullDataFormatter$,fullChartParams$:e.fullChartParams$,gridAxesTransform$:e.gridAxesTransform$,gridGraphicTransform$:e.gridGraphicTransform$,gridAxesSize$:e.gridAxesSize$,gridHighlight$:e.gridHighlight$,gridContainerPosition$:e.gridContainerPosition$,allContainerPosition$:e.gridContainerPosition$,layout$:e.layout$,event$:i.event$});return()=>{o.next(void 0),b()}});function Je(r="curveLinear",n){return Ge().x(t=>t.axisX).y0(t=>n).y1(t=>t.axisY).curve(Ce[r])}function Qe(r){let n=[[]],t=0;for(let e in r){if(r[e].visible==!1||r[e].value===void 0||r[e].value===null){n[t].length&&(t++,n[t]=[]);continue}n[t].push(r[e])}return n}function et({selection:r,pathClassName:n,segmentData:t,areaPath:e,linearGradientIds:i,params:o}){return r.selectAll("path").data(t,(d,D)=>d.length?`${d[0].id}_${d[d.length-1].id}`:D).join(d=>d.append("path").classed(n,!0).attr("fill","none").style("vector-effect","non-scaling-stroke").style("cursor","pointer"),d=>d,d=>d.remove()).attr("fill",(d,D)=>d[0]?`url(#${i[d[0].seriesIndex]})`:"").attr("d",d=>e(d))}function tt({selection:r,seriesLabel:n,fullChartParams:t}){if(r.interrupt("highlight"),!n){r.transition("highlight").duration(200).style("opacity",1);return}r.each((e,i,o)=>{e===n?O(o[i]).style("opacity",1):O(o[i]).style("opacity",t.styles.unhighlightedOpacity)})}function rt({defsSelection:r,computedData:n,linearGradientIds:t,params:e}){r.selectAll("linearGradient").data(n??[]).join(i=>i.append("linearGradient").attr("x1","0%").attr("x2","0%").attr("y1","100%").attr("y2","0%").attr("spreadMethod","pad"),i=>i,i=>i.remove()).attr("id",(i,o)=>i[0]?t[i[0].seriesIndex]:"").html((i,o)=>{const b=i[0]?i[0].color:"";return`
        <stop offset="0%"   stop-color="${b}" stop-opacity="${e.linearGradientOpacity[0]}"/>
        <stop offset="100%" stop-color="${b}" stop-opacity="${e.linearGradientOpacity[1]}"/>
      `})}function it({defsSelection:r,clipPathData:n,transitionDuration:t,transitionEase:e}){r.selectAll("clipPath").data(n).join(i=>i.append("clipPath"),i=>i,i=>i.remove()).attr("id",i=>i.id).each((i,o,b)=>{O(b[o]).selectAll("rect").data([i]).join(d=>{const D=d.append("rect");return D.transition().duration(t).ease(ue(e)).tween("tween",(A,C,G)=>w=>{const P=A.width*w;D.attr("x",0).attr("y",0).attr("width",M=>P).attr("height",M=>M.height)}),D},d=>d.attr("x",0).attr("y",0).attr("width",D=>D.width).attr("height",D=>D.height),d=>d.remove())})}const at=(r,{selection:n,computedData$:t,computedAxesData$:e,visibleComputedData$:i,visibleComputedAxesData$:o,seriesLabels$:b,SeriesDataMap$:d,GroupDataMap$:D,fullParams$:A,fullDataFormatter$:C,fullChartParams$:G,gridAxesTransform$:w,gridGraphicTransform$:P,gridAxesSize$:M,gridHighlight$:B,gridContainerPosition$:F,layout$:x,event$:z})=>{const L=new X,f=se(r,"clipPath-box"),p=Z(r,"path"),{seriesSelection$:h,axesSelection$:S,defsSelection$:R,graphicGSelection$:Y}=oe({selection:n,pluginName:r,clipPathID:f,seriesLabels$:b,gridContainerPosition$:F,gridAxesTransform$:w,gridGraphicTransform$:P}),V=P.pipe(m(L),y(c=>-c.translate[1]/c.scale[1])),q=new re(c=>{const _=T({fullParams:A,valueAxisStart:V}).pipe(m(L)).subscribe(a=>{const g=Je(a.fullParams.lineCurve,a.valueAxisStart);c.next(g)});return()=>{_.unsubscribe()}}),k=G.pipe(y(c=>c.transitionDuration),E()),H=G.pipe(y(c=>c.transitionEase),E());T({defsSelection:R,seriesLabels:b,axisSize:M,transitionDuration:k,transitionEase:H}).pipe(m(L),I(async c=>c)).subscribe(c=>{const a=[{id:f,width:c.axisSize.width,height:c.axisSize.height}].concat(c.seriesLabels.map(g=>({id:`orbcharts__clipPath_${g}`,width:c.axisSize.width,height:c.axisSize.height})));it({defsSelection:c.defsSelection,clipPathData:a,transitionDuration:c.transitionDuration,transitionEase:c.transitionEase})});const J=t.pipe(y(c=>{const _=new Map;return c.flat().forEach(a=>_.set(a.id,a)),_})),Q=ve({fullDataFormatter$:C,gridAxesSize$:M,computedData$:t,fullChartParams$:G,gridContainerPosition$:F,layout$:x}),v=G.pipe(m(L),y(c=>c.highlightTarget),E()),ee=b.pipe(m(L),y(c=>c.map((_,a)=>se(r,`lineargradient-${_}`)))),ie=T({graphicGSelection:Y,defsSelection:R,visibleComputedAxesData:o,linearGradientIds:ee,areaPath:q,params:A}).pipe(m(L),I(async c=>c),y(c=>{let _=[];return c.graphicGSelection.each((a,g,u)=>{const N=Qe(c.visibleComputedAxesData[g]??[]);_[g]=et({selection:O(u[g]),pathClassName:p,areaPath:c.areaPath,segmentData:N,linearGradientIds:c.linearGradientIds,params:c.params}),rt({defsSelection:c.defsSelection,computedData:c.visibleComputedAxesData,linearGradientIds:c.linearGradientIds,params:c.params})}),_}));return T({pathSelectionArr:ie,computedData:t,SeriesDataMap:d,GroupDataMap:D,highlightTarget:v,gridGroupPositionFn:Q}).pipe(m(L),I(async c=>c)).subscribe(c=>{c.pathSelectionArr.forEach(_=>{_.on("mouseover",(a,g)=>{const u=g[0]?g[0].seriesLabel:"",{groupIndex:N,groupLabel:U}=c.gridGroupPositionFn(a),l=c.GroupDataMap.get(U).find(W=>W.seriesLabel===u)??g[0];z.next({type:"grid",eventName:"mouseover",pluginName:r,highlightTarget:c.highlightTarget,datum:l,gridIndex:l.gridIndex,series:c.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,group:c.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:a,data:c.computedData})}).on("mousemove",(a,g)=>{const u=g[0]?g[0].seriesLabel:"",{groupIndex:N,groupLabel:U}=c.gridGroupPositionFn(a),l=c.GroupDataMap.get(U).find(W=>W.seriesLabel===u)??g[0];z.next({type:"grid",eventName:"mousemove",pluginName:r,highlightTarget:c.highlightTarget,datum:l,gridIndex:l.gridIndex,series:c.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,group:c.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:a,data:c.computedData})}).on("mouseout",(a,g)=>{const u=g[0]?g[0].seriesLabel:"",{groupIndex:N,groupLabel:U}=c.gridGroupPositionFn(a),l=c.GroupDataMap.get(U).find(W=>W.seriesLabel===u)??g[0];z.next({type:"grid",eventName:"mouseout",pluginName:r,highlightTarget:c.highlightTarget,datum:l,gridIndex:l.gridIndex,series:c.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,group:c.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:a,data:c.computedData})}).on("click",(a,g)=>{const u=g[0]?g[0].seriesLabel:"",{groupIndex:N,groupLabel:U}=c.gridGroupPositionFn(a),l=c.GroupDataMap.get(U).find(W=>W.seriesLabel===u)??g[0];z.next({type:"grid",eventName:"click",pluginName:r,highlightTarget:c.highlightTarget,datum:l,gridIndex:l.gridIndex,series:c.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,group:c.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:a,data:c.computedData})})})}),G.pipe(m(L),Ie(c=>c.highlightTarget==="series"),I(c=>T({graphicGSelection:Y,gridHighlight:B,DataMap:J,fullChartParams:G}).pipe(m(L),I(async _=>_)))).subscribe(c=>{const _=c.gridHighlight[0]?c.gridHighlight[0].seriesLabel:null;tt({selection:c.graphicGSelection,seriesLabel:_,fullChartParams:c.fullChartParams})}),()=>{L.next(void 0)}},De="LineAreas",st={name:De,defaultParams:Me,layerIndex:Be,validator:(r,{validateColumns:n})=>n(r,{lineCurve:{toBeTypes:["string"]},linearGradientOpacity:{toBe:"[number, number]",test:e=>Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number"}})},kt=K(st)(({selection:r,name:n,observer:t,subject:e})=>{const i=new X,o=at(De,{selection:r,computedData$:t.computedData$,visibleComputedData$:t.visibleComputedData$,computedAxesData$:t.computedAxesData$,visibleComputedAxesData$:t.visibleComputedAxesData$,seriesLabels$:t.seriesLabels$,SeriesDataMap$:t.SeriesDataMap$,GroupDataMap$:t.GroupDataMap$,fullParams$:t.fullParams$,fullDataFormatter$:t.fullDataFormatter$,fullChartParams$:t.fullChartParams$,gridAxesTransform$:t.gridAxesTransform$,gridGraphicTransform$:t.gridGraphicTransform$,gridAxesSize$:t.gridAxesSize$,gridHighlight$:t.gridHighlight$,gridContainerPosition$:t.gridContainerPosition$,allContainerPosition$:t.gridContainerPosition$,layout$:t.layout$,event$:e.event$});return()=>{i.next(void 0),o()}}),fe=.3;function nt({axisWidth:r,groupAmount:n,barGroupPadding:t=0}){const i=(n>1?r/(n-1):r)-t;return i>1?i:1}function ot(r,n){return r<=1?0:n/(r-1)*fe}function lt(r,n){return r<=1?n:n*(1-fe)}function pt({graphicGSelection:r,rectClassName:n,barData:t,zeroY:e,groupLabels:i,params:o,chartParams:b,barWidth:d,transformedBarRadius:D,delayGroup:A,transitionItem:C,isSeriesSeprate:G}){const w=d/2;return r.each((M,B,F)=>{O(F[B]).selectAll(`rect.${n}`).data(t[B]??[],x=>x.id).join(x=>x.append("rect").classed(n,!0).attr("cursor","pointer").attr("height",z=>1),x=>x,x=>x.remove()).attr("transform",(x,z)=>`translate(${(x?x.axisX:0)-w}, 0)`).attr("fill",x=>x.color).attr("y",x=>e).attr("x",x=>0).attr("width",d).attr("rx",D[B][0]??1).attr("ry",D[B][1]??1).transition().duration(C).ease(ue(b.transitionEase)).delay((x,z)=>x.groupIndex*A).attr("y",x=>x._barStartY).attr("height",x=>x._barHeight>0?Math.abs(x._barHeight):1)}),r.selectAll(`rect.${n}`)}function ct({defsSelection:r,clipPathData:n}){r.selectAll("clipPath").data(n).join(t=>t.append("clipPath"),t=>t,t=>t.remove()).attr("id",t=>t.id).each((t,e,i)=>{O(i[e]).selectAll("rect").data([t]).join(o=>o.append("rect"),o=>o,o=>o.remove()).attr("x",0).attr("y",0).attr("width",o=>o.width).attr("height",o=>o.height)})}function gt({selection:r,ids:n,fullChartParams:t}){if(r.interrupt("highlight"),!n.length){r.transition("highlight").duration(200).style("opacity",1);return}r.each((e,i,o)=>{n.includes(e.id)?O(o[i]).style("opacity",1):O(o[i]).style("opacity",t.styles.unhighlightedOpacity)})}const ut=(r,{selection:n,computedData$:t,computedAxesData$:e,visibleComputedData$:i,visibleComputedAxesData$:o,filteredMinMaxValue$:b,filteredStackedMinMaxValue$:d,seriesLabels$:D,SeriesDataMap$:A,GroupDataMap$:C,fullParams$:G,fullDataFormatter$:w,fullChartParams$:P,gridAxesTransform$:M,gridGraphicTransform$:B,gridGraphicReverseScale$:F,gridAxesSize$:x,gridHighlight$:z,gridContainerPosition$:L,isSeriesSeprate$:f,event$:p})=>{const h=new X,S=se(r,"clipPath-box"),R=Z(r,"rect"),{seriesSelection$:Y,axesSelection$:V,defsSelection$:q,graphicGSelection$:k}=oe({selection:n,pluginName:r,clipPathID:S,seriesLabels$:D,gridContainerPosition$:L,gridAxesTransform$:M,gridGraphicTransform$:B}),H=o.pipe(m(h),y(s=>s[0]&&s[0][0]?s[0][0].axisY-s[0][0].axisYFromZero:0),E()),J=T({computedData:t,params:G,axisSize:x,isSeriesSeprate:f}).pipe(m(h),I(async s=>s),y(s=>s.params.barWidth?s.params.barWidth:nt({axisWidth:s.axisSize.width,groupAmount:s.computedData[0]?s.computedData[0].length:0,barGroupPadding:s.params.barGroupPadding})),E()),Q=T({computedData:t,barWidth:J,params:G,gridGraphicReverseScale:F}).pipe(m(h),I(async s=>s),y(s=>{const $=s.barWidth/2,l=s.params.barRadius===!0?$:s.params.barRadius===!1?0:typeof s.params.barRadius=="number"?s.params.barRadius:0;return s.computedData.map((W,te)=>{const j=s.gridGraphicReverseScale[te]??s.gridGraphicReverseScale[0],le=l*j[0],ae=l*j[1];return[le,ae]})})),v=i.pipe(m(h),y(s=>{const $=new Set;return s.forEach(l=>{l.forEach(W=>{$.add(W.groupLabel)})}),Array.from($)}),Re(1)),ee=P.pipe(m(h),y(s=>s.transitionDuration),E()),ie=new re(s=>{T({groupLabels:v,transitionDuration:ee}).pipe(I(async $=>$)).subscribe($=>{const l=ot($.groupLabels.length,$.transitionDuration);s.next(l)})}).pipe(m(h),E()),c=new re(s=>{T({groupLabels:v,transitionDuration:ee}).pipe(I(async $=>$)).subscribe($=>{const l=lt($.groupLabels.length,$.transitionDuration);s.next(l)})}).pipe(m(h),E());T({computedData:t,dataFormatter:w}).pipe(m(h),I(async s=>s),y(s=>{const $=s.computedData[0]?s.computedData[0].length-1:0,l=s.dataFormatter.groupAxis.scaleDomain[0],W=s.dataFormatter.groupAxis.scaleDomain[1]==="max"?$:s.dataFormatter.groupAxis.scaleDomain[1];return[l,W]}));const _=T({filteredMinMaxValue:b,filteredStackedMinMaxValue:d}).pipe(m(h),I(async s=>s),y(s=>s.filteredMinMaxValue[1]/s.filteredStackedMinMaxValue[1])),a=T({computedAxesData:e,yRatio:_,zeroY:H}).pipe(m(h),y(s=>{let $=s.computedAxesData[0]?s.computedAxesData[0].map(()=>s.zeroY):[];return s.computedAxesData.map((l,W)=>l.map((te,j)=>{$[j]||($[j]=0);const le=$[j];let ae=0;return te.visible&&(ae=te.axisYFromZero*s.yRatio,$[j]=$[j]+ae),{...te,_barStartY:le,_barHeight:ae}}))})),g=T({computedAxesData:e,zeroY:H}).pipe(m(h),y(s=>s.computedAxesData.map(($,l)=>$.map((W,te)=>({...W,_barStartY:s.zeroY,_barHeight:W.axisYFromZero}))))),u=f.pipe(I(s=>me(()=>s,g,a)));T({defsSelection:q,gridAxesSize:x}).pipe(m(h),I(async s=>s)).subscribe(s=>{const $=[{id:S,width:s.gridAxesSize.width,height:s.gridAxesSize.height}];ct({defsSelection:s.defsSelection,clipPathData:$})});const N=P.pipe(m(h),y(s=>s.highlightTarget),E()),U=T({graphicGSelection:k,graphicData:u,zeroY:H,groupLabels:v,params:G,chartParams:P,highlightTarget:N,barWidth:J,transformedBarRadius:Q,delayGroup:ie,transitionItem:c,isSeriesSeprate:f}).pipe(m(h),I(async s=>s),y(s=>pt({graphicGSelection:s.graphicGSelection,rectClassName:R,barData:s.graphicData,zeroY:s.zeroY,groupLabels:s.groupLabels,params:s.params,chartParams:s.chartParams,barWidth:s.barWidth,transformedBarRadius:s.transformedBarRadius,delayGroup:s.delayGroup,transitionItem:s.transitionItem,isSeriesSeprate:s.isSeriesSeprate})));return T({barSelection:U,computedData:t,highlightTarget:N,SeriesDataMap:A,GroupDataMap:C}).subscribe(s=>{s.barSelection.on("mouseover",($,l)=>{$.stopPropagation(),p.next({type:"grid",eventName:"mouseover",pluginName:r,highlightTarget:s.highlightTarget,datum:l,gridIndex:l.gridIndex,series:s.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,group:s.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:$,data:s.computedData})}).on("mousemove",($,l)=>{$.stopPropagation(),p.next({type:"grid",eventName:"mousemove",pluginName:r,highlightTarget:s.highlightTarget,datum:l,gridIndex:l.gridIndex,series:s.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,group:s.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:$,data:s.computedData})}).on("mouseout",($,l)=>{$.stopPropagation(),p.next({type:"grid",eventName:"mouseout",pluginName:r,highlightTarget:s.highlightTarget,datum:l,gridIndex:l.gridIndex,series:s.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,group:s.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:$,data:s.computedData})}).on("click",($,l)=>{$.stopPropagation(),p.next({type:"grid",eventName:"click",pluginName:r,highlightTarget:s.highlightTarget,datum:l,gridIndex:l.gridIndex,series:s.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,group:s.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:$,data:s.computedData})})}),T({barSelection:U,highlight:z.pipe(y(s=>s.map($=>$.id))),fullChartParams:P}).pipe(m(h),I(async s=>s)).subscribe(s=>{gt({selection:s.barSelection,ids:s.highlight,fullChartParams:s.fullChartParams})}),()=>{h.next(void 0)}},be="StackedBars",ht={name:be,defaultParams:we,layerIndex:5,validator:(r,{validateColumns:n})=>n(r,{barWidth:{toBeTypes:["number"]},barGroupPadding:{toBeTypes:["number"]},barRadius:{toBeTypes:["number","boolean"]}})},Et=K(ht)(({selection:r,name:n,subject:t,observer:e})=>{const i=new X,o=ut(be,{selection:r,computedData$:e.computedData$,computedAxesData$:e.computedAxesData$,visibleComputedData$:e.visibleComputedData$,visibleComputedAxesData$:e.visibleComputedAxesData$,filteredMinMaxValue$:e.filteredMinMaxValue$,filteredStackedMinMaxValue$:e.filteredStackedMinMaxValue$,seriesLabels$:e.seriesLabels$,SeriesDataMap$:e.SeriesDataMap$,GroupDataMap$:e.GroupDataMap$,fullParams$:e.fullParams$,fullDataFormatter$:e.fullDataFormatter$,fullChartParams$:e.fullChartParams$,gridAxesTransform$:e.gridAxesTransform$,gridGraphicTransform$:e.gridGraphicTransform$,gridGraphicReverseScale$:e.gridGraphicReverseScale$,gridAxesSize$:e.gridAxesSize$,gridHighlight$:e.gridHighlight$,gridContainerPosition$:e.gridContainerPosition$,isSeriesSeprate$:e.isSeriesSeprate$,event$:t.event$});return()=>{i.next(void 0),o()}}),ye=.3;function de({axisWidth:r,groupAmount:n,barAmountOfGroup:t,barPadding:e=0,barGroupPadding:i=0}){const b=((n>1?r/(n-1):r)-i)/t-e;return b>1?b:1}function dt(r,n,t){const e=r/2,i=r*n.length+t.barPadding*n.length;return _e().domain(n).range([-i/2+e,i/2-e])}function xt(r,n){return r<=1?0:n/(r-1)*ye}function mt(r,n){return r<=1?n:n*(1-ye)}function $t({graphicGSelection:r,pathGClassName:n,pathClassName:t,visibleComputedAxesData:e,linearGradientIds:i,zeroYArr:o,groupLabels:b,barScale:d,params:D,chartParams:A,barWidth:C,delayGroup:G,transitionItem:w,isSeriesSeprate:P}){const M=C/2;return r.each((F,x,z)=>{O(z[x]).selectAll(`g.${n}`).data(e[x]??[]).join(f=>{const p=f.append("g").classed(n,!0).attr("cursor","pointer");return p.append("path").classed(t,!0).style("vector-effect","non-scaling-stroke").attr("d",h=>{const S=-M,R=o[x],Y=o[x];return`M${S},${R} L${S+C/2},${Y} ${S+C},${R}`}),p},f=>f,f=>f.remove()).attr("transform",f=>`translate(${P?0:d(f.seriesLabel)}, 0)`).select(`path.${t}`).attr("height",f=>Math.abs(f.axisYFromZero)||1).attr("y",f=>f.axisY<o[x]?f.axisY:o[x]).attr("x",f=>P?0:d(f.seriesLabel)).style("fill",f=>`url(#${i[f.seriesIndex]})`).attr("stroke",f=>f.color).attr("transform",f=>`translate(${f?f.axisX:0}, 0)`).transition().duration(w).ease(ue(A.transitionEase)).delay((f,p)=>f.groupIndex*G).attr("d",f=>{const p=-M,h=o[x],S=f.axisY;return`M${p},${h} L${p+C/2},${S} ${p+C},${h}`})}),r.selectAll(`path.${t}`)}function Dt({defsSelection:r,computedData:n,linearGradientIds:t,params:e}){r.selectAll("linearGradient").data(n??[]).join(i=>i.append("linearGradient").attr("x1","0%").attr("x2","0%").attr("y1","100%").attr("y2","0%").attr("spreadMethod","pad"),i=>i,i=>i.remove()).attr("id",(i,o)=>i[0]?t[i[0].seriesIndex]:"").html((i,o)=>{const b=i[0]?i[0].color:"";return`
        <stop offset="0%"   stop-color="${b}" stop-opacity="${e.linearGradientOpacity[0]}"/>
        <stop offset="100%" stop-color="${b}" stop-opacity="${e.linearGradientOpacity[1]}"/>
      `})}function ft({defsSelection:r,clipPathData:n}){r.selectAll("clipPath").data(n).join(t=>t.append("clipPath"),t=>t,t=>t.remove()).attr("id",t=>t.id).each((t,e,i)=>{O(i[e]).selectAll("rect").data([t]).join(o=>o.append("rect"),o=>o,o=>o.remove()).attr("x",0).attr("y",0).attr("width",o=>o.width).attr("height",o=>o.height)})}function bt({selection:r,ids:n,fullChartParams:t}){r.interrupt("highlight");const e=()=>{r.transition("highlight").duration(200).style("opacity",1)};if(!n.length){e();return}r.each((i,o,b)=>{n.includes(i.id)?O(b[o]).style("opacity",1):O(b[o]).style("opacity",t.styles.unhighlightedOpacity)})}const yt=(r,{selection:n,computedData$:t,computedAxesData$:e,visibleComputedData$:i,visibleComputedAxesData$:o,fullDataFormatter$:b,seriesLabels$:d,SeriesDataMap$:D,GroupDataMap$:A,fullParams$:C,fullChartParams$:G,gridAxesTransform$:w,gridGraphicTransform$:P,gridAxesSize$:M,gridHighlight$:B,gridContainerPosition$:F,isSeriesSeprate$:x,event$:z})=>{const L=new X,f=se(r,"clipPath-box"),p=Z(r,"pathG"),h=Z(r,"path"),{seriesSelection$:S,axesSelection$:R,defsSelection$:Y,graphicGSelection$:V}=oe({selection:n,pluginName:r,clipPathID:f,seriesLabels$:d,gridContainerPosition$:F,gridAxesTransform$:w,gridGraphicTransform$:P});P.pipe(m(L),y(a=>-a.translate[1]/a.scale[1]));const q=o.pipe(y(a=>a.map(g=>g[0]?g[0].axisY-g[0].axisYFromZero:0)),E()),k=T({computedData:t,visibleComputedData:i,params:C,gridAxesSize:M,isSeriesSeprate:x}).pipe(m(L),I(async a=>a),y(a=>a.params.barWidth?a.params.barWidth:a.isSeriesSeprate?de({axisWidth:a.gridAxesSize.width,groupAmount:a.computedData[0]?a.computedData[0].length:0,barAmountOfGroup:1,barPadding:a.params.barPadding,barGroupPadding:a.params.barGroupPadding}):de({axisWidth:a.gridAxesSize.width,groupAmount:a.computedData[0]?a.computedData[0].length:0,barAmountOfGroup:a.visibleComputedData.length,barPadding:a.params.barPadding,barGroupPadding:a.params.barGroupPadding}))),H=i.pipe(m(L),y(a=>{const g=new Set;return a.forEach(u=>{u.forEach(N=>{g.add(N.groupLabel)})}),Array.from(g)})),J=new re(a=>{T({seriesLabels:d,barWidth:k,params:C}).pipe(m(L),I(async g=>g)).subscribe(g=>{const u=dt(g.barWidth,g.seriesLabels,g.params);a.next(u)})}),Q=G.pipe(m(L),y(a=>a.transitionDuration),E()),v=new re(a=>{T({groupLabels:H,transitionDuration:Q}).pipe(I(async g=>g)).subscribe(g=>{const u=xt(g.groupLabels.length,g.transitionDuration);a.next(u)})}).pipe(m(L),E()),ee=new re(a=>{T({groupLabels:H,transitionDuration:Q}).pipe(I(async g=>g)).subscribe(g=>{const u=mt(g.groupLabels.length,g.transitionDuration);a.next(u)})}).pipe(m(L),E());T({defsSelection:Y,gridAxesSize:M}).pipe(m(L),I(async a=>a)).subscribe(a=>{const g=[{id:f,width:a.gridAxesSize.width,height:a.gridAxesSize.height}];ft({defsSelection:a.defsSelection,clipPathData:g})});const ie=G.pipe(m(L),y(a=>a.highlightTarget),E()),c=d.pipe(m(L),y(a=>a.map((g,u)=>se(r,`lineargradient-${g}`)))),_=T({graphicGSelection:V,defsSelection:Y,computedData:t,visibleComputedAxesData:o,linearGradientIds:c,zeroYArr:q,groupLabels:H,barScale:J,params:C,chartParams:G,barWidth:k,delayGroup:v,transitionItem:ee,isSeriesSeprate:x}).pipe(m(L),I(async a=>a),y(a=>(Dt({defsSelection:a.defsSelection,computedData:a.computedData,linearGradientIds:a.linearGradientIds,params:a.params}),$t({graphicGSelection:a.graphicGSelection,pathGClassName:p,pathClassName:h,visibleComputedAxesData:a.visibleComputedAxesData,linearGradientIds:a.linearGradientIds,zeroYArr:a.zeroYArr,groupLabels:a.groupLabels,barScale:a.barScale,params:a.params,chartParams:a.chartParams,barWidth:a.barWidth,delayGroup:a.delayGroup,transitionItem:a.transitionItem,isSeriesSeprate:a.isSeriesSeprate}))));return T({barSelection:_,computedData:t,highlightTarget:ie,SeriesDataMap:D,GroupDataMap:A}).subscribe(a=>{a.barSelection.on("mouseover",(g,u)=>{g.stopPropagation(),z.next({type:"grid",eventName:"mouseover",pluginName:r,highlightTarget:a.highlightTarget,datum:u,gridIndex:u.gridIndex,series:a.SeriesDataMap.get(u.seriesLabel),seriesIndex:u.seriesIndex,seriesLabel:u.seriesLabel,group:a.GroupDataMap.get(u.groupLabel),groupIndex:u.groupIndex,groupLabel:u.groupLabel,event:g,data:a.computedData})}).on("mousemove",(g,u)=>{g.stopPropagation(),z.next({type:"grid",eventName:"mousemove",pluginName:r,highlightTarget:a.highlightTarget,datum:u,gridIndex:u.gridIndex,series:a.SeriesDataMap.get(u.seriesLabel),seriesIndex:u.seriesIndex,seriesLabel:u.seriesLabel,group:a.GroupDataMap.get(u.groupLabel),groupIndex:u.groupIndex,groupLabel:u.groupLabel,event:g,data:a.computedData})}).on("mouseout",(g,u)=>{g.stopPropagation(),z.next({type:"grid",eventName:"mouseout",pluginName:r,highlightTarget:a.highlightTarget,datum:u,gridIndex:u.gridIndex,series:a.SeriesDataMap.get(u.seriesLabel),seriesIndex:u.seriesIndex,seriesLabel:u.seriesLabel,group:a.GroupDataMap.get(u.groupLabel),groupIndex:u.groupIndex,groupLabel:u.groupLabel,event:g,data:a.computedData})}).on("click",(g,u)=>{g.stopPropagation(),z.next({type:"grid",eventName:"click",pluginName:r,highlightTarget:a.highlightTarget,datum:u,gridIndex:u.gridIndex,series:a.SeriesDataMap.get(u.seriesLabel),seriesIndex:u.seriesIndex,seriesLabel:u.seriesLabel,group:a.GroupDataMap.get(u.groupLabel),groupIndex:u.groupIndex,groupLabel:u.groupLabel,event:g,data:a.computedData})})}),T({barSelection:_,highlight:B.pipe(y(a=>a.map(g=>g.id))),fullChartParams:G}).pipe(m(L),I(async a=>a)).subscribe(a=>{bt({selection:a.barSelection,ids:a.highlight,fullChartParams:a.fullChartParams})}),()=>{L.next(void 0)}},Se="BarsTriangle",St={name:Se,defaultParams:ze,layerIndex:5,validator:(r,{validateColumns:n})=>n(r,{barWidth:{toBeTypes:["number"]},barPadding:{toBeTypes:["number"]},barGroupPadding:{toBeTypes:["number"]},linearGradientOpacity:{toBe:"[number, number]",test:e=>Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number"}})},Wt=K(St)(({selection:r,name:n,subject:t,observer:e})=>{const i=new X,o=yt(Se,{selection:r,computedData$:e.computedData$,computedAxesData$:e.computedAxesData$,visibleComputedData$:e.visibleComputedData$,visibleComputedAxesData$:e.visibleComputedAxesData$,fullDataFormatter$:e.fullDataFormatter$,seriesLabels$:e.seriesLabels$,SeriesDataMap$:e.SeriesDataMap$,GroupDataMap$:e.GroupDataMap$,fullParams$:e.fullParams$,fullChartParams$:e.fullChartParams$,gridAxesTransform$:e.gridAxesTransform$,gridGraphicTransform$:e.gridGraphicTransform$,gridAxesSize$:e.gridAxesSize$,gridHighlight$:e.gridHighlight$,gridContainerPosition$:e.gridContainerPosition$,isSeriesSeprate$:e.isSeriesSeprate$,event$:t.event$});return()=>{i.next(void 0),o()}}),Ae="Dots",At={name:Ae,defaultParams:Fe,layerIndex:ke,validator:(r,{validateColumns:n})=>n(r,{radius:{toBeTypes:["number"]},fillColorType:{toBeOption:"ColorType"},strokeColorType:{toBeOption:"ColorType"},strokeWidth:{toBeTypes:["number"]},onlyShowHighlighted:{toBeTypes:["boolean"]}})},Ot=K(At)(({selection:r,name:n,subject:t,observer:e})=>{const i=new X,o=je(Ae,{selection:r,computedData$:e.computedData$,computedAxesData$:e.computedAxesData$,visibleComputedData$:e.visibleComputedData$,visibleComputedAxesData$:e.visibleComputedAxesData$,seriesLabels$:e.seriesLabels$,SeriesDataMap$:e.SeriesDataMap$,GroupDataMap$:e.GroupDataMap$,fullParams$:e.fullParams$,fullChartParams$:e.fullChartParams$,gridAxesTransform$:e.gridAxesTransform$,gridGraphicTransform$:e.gridGraphicTransform$,gridGraphicReverseScale$:e.gridGraphicReverseScale$,gridAxesSize$:e.gridAxesSize$,gridHighlight$:e.gridHighlight$,gridContainerPosition$:e.gridContainerPosition$,event$:t.event$});return()=>{i.next(void 0),o()}}),Le="StackedValueAxis",Lt={name:Le,defaultParams:Ee,layerIndex:We,validator:(r,{validateColumns:n})=>n(r,{labelOffset:{toBe:"[number, number]",test:e=>Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number"},labelColorType:{toBeOption:"ColorType"},axisLineVisible:{toBeTypes:["boolean"]},axisLineColorType:{toBeOption:"ColorType"},ticks:{toBeTypes:["number","null"]},tickFormat:{toBeTypes:["string","Function"]},tickLineVisible:{toBeTypes:["boolean"]},tickPadding:{toBeTypes:["number"]},tickFullLine:{toBeTypes:["boolean"]},tickFullLineDasharray:{toBeTypes:["string"]},tickColorType:{toBeOption:"ColorType"},tickTextRotate:{toBeTypes:["number"]},tickTextColorType:{toBeOption:"ColorType"}})},Ht=K(Lt)(({selection:r,name:n,observer:t,subject:e})=>{const i=new X,o=Ze(Le,{selection:r,computedData$:t.computedStackedData$,filteredMinMaxValue$:t.filteredStackedMinMaxValue$,fullParams$:t.fullParams$,fullDataFormatter$:t.fullDataFormatter$,fullChartParams$:t.fullChartParams$,gridAxesTransform$:t.gridAxesTransform$,gridAxesReverseTransform$:t.gridAxesReverseTransform$,gridAxesSize$:t.gridAxesSize$,gridContainerPosition$:t.gridContainerPosition$,isSeriesSeprate$:t.isSeriesSeprate$});return()=>{i.next(void 0),o()}}),ne="GroupAux",ge=Z(ne,"label-box"),pe=6,xe=3,Tt={name:ne,defaultParams:Oe,layerIndex:He,validator:(r,{validateColumns:n})=>n(r,{showLine:{toBeTypes:["boolean"]},showLabel:{toBeTypes:["boolean"]},lineDashArray:{toBeTypes:["string"]},lineColorType:{toBeOption:"ColorType"},labelColorType:{toBeOption:"ColorType"},labelTextColorType:{toBeOption:"ColorType"},labelTextFormat:{toBeTypes:["string","Function"]},labelPadding:{toBeTypes:["number"]},labelRotate:{toBeTypes:["number"]}})};function Pt({groupLabel:r,axisX:n,axisHeight:t,fullParams:e}){return e.showLine&&r?[{id:r,x1:n,x2:n,y1:0,y2:t}]:[]}function It({groupLabel:r,axisX:n,fullParams:t,textSizePx:e,rowAmount:i}){const o=Ye(r,t.labelTextFormat),b=o.split(`
`),d=b.reduce((C,G)=>G.length>C.length?G:C,""),D=Ve(d,e),A=e*b.length;return t.showLabel&&r?[{id:r,x:n,y:-t.labelPadding*i,text:o,textArr:b,textWidth:D,textHeight:A}]:[]}function Gt({selection:r,pluginName:n,lineData:t,fullParams:e,fullChartParams:i}){const o=Z(n,"auxline");return r.selectAll(`line.${o}`).data(t).join(d=>d.append("line").classed(o,!0).style("stroke-width",1).style("pointer-events","none").style("vector-effect","non-scaling-stroke").attr("x1",D=>D.x1).attr("y1",D=>D.y1).attr("x2",D=>D.x2).attr("y2",D=>D.y2),d=>d.transition().duration(50).attr("x1",A=>A.x1).attr("y1",A=>A.y1).attr("x2",A=>A.x2).attr("y2",A=>A.y2),d=>d.remove()).style("stroke",d=>ce(e.lineColorType,i)).style("stroke-dasharray",e.lineDashArray??"none")}function Ct(r){r.selectAll("line").data([]).exit().remove()}function Mt({selection:r,labelData:n,fullParams:t,fullDataFormatter:e,fullChartParams:i,textReverseTransformWithRotate:o,textSizePx:b}){return r.selectAll(`g.${ge}`).data(n).join(D=>D.append("g").classed(ge,!0).style("cursor","pointer").attr("transform",(A,C)=>`translate(${A.x}, ${A.y})`),D=>D.transition().duration(50).attr("transform",(C,G)=>`translate(${C.x}, ${C.y})`),D=>D.remove()).each((D,A,C)=>{const G=O(C[A]),w=D.textWidth+pe*2,P=D.textHeight+xe*2;let M=-w/2,B=-2,F=M,x=B-3;e.groupAxis.position==="bottom"?(M=t.labelRotate?-w+P:-w/2,B=2,F=M,x=B-3):e.groupAxis.position==="left"?(M=-w+2,B=-P/2,F=M,x=B-3,t.labelRotate&&(x+=P)):e.groupAxis.position==="right"?(M=-2,B=-P/2,F=M,x=B-3,t.labelRotate&&(x+=P)):e.groupAxis.position==="top"&&(M=t.labelRotate?-w+P:-w/2,B=-P+6,F=-P,x=B-3);const z=G.selectAll("rect").data([D]).join(h=>h.append("rect").style("cursor","pointer").attr("rx",5).attr("ry",5),h=>h,h=>h.remove()).attr("width",h=>`${w}px`).attr("height",`${P}px`).attr("fill",h=>ce(t.labelColorType,i)).attr("x",F).attr("y",x).style("transform",o),L=G.selectAll("text").data([D]).join(h=>h.append("text").style("dominant-baseline","hanging").style("cursor","pointer"),h=>h,h=>h.remove()).style("transform",o).attr("fill",h=>ce(t.labelTextColorType,i)).attr("font-size",i.styles.textSize).attr("x",F+pe).attr("y",x+xe).each((h,S,R)=>{Ne(O(R[S]),{textArr:D.textArr,textSizePx:b,groupAxisPosition:e.groupAxis.position,isContainerRotated:!1})});let f=[];L.selectAll("tspan").each((h,S,R)=>{const V=O(R[S]).node();V&&V.getBBox()&&f.push(V.getBBox().width)});const p=Math.max(...f);z.attr("width",p+pe*2)})}function Bt(r){r.selectAll(`g.${ge}`).data([]).exit().remove()}const Yt=K(Tt)(({selection:r,rootSelection:n,name:t,subject:e,observer:i})=>{const o=new X;let b=!1;const d=n.insert("rect","g").classed(Z(ne,"rect"),!0).attr("opacity",0),{seriesSelection$:D,axesSelection$:A,defsSelection$:C,graphicGSelection$:G}=oe({selection:r,pluginName:ne,clipPathID:"test",seriesLabels$:i.isSeriesSeprate$.pipe(I(p=>me(()=>p,i.seriesLabels$,i.seriesLabels$.pipe(y(h=>[h[0]]))))),gridContainerPosition$:i.gridContainerPosition$,gridAxesTransform$:i.gridAxesTransform$,gridGraphicTransform$:i.gridGraphicTransform$});i.layout$.pipe(m(o)).subscribe(p=>{d.attr("width",p.rootWidth).attr("height",p.rootHeight)});const w=T({groupScaleDomainValue:i.groupScaleDomainValue$,gridAxesSize:i.gridAxesSize$}).pipe(m(o),I(async p=>p),y(p=>Ue().domain(p.groupScaleDomainValue).range([0,p.gridAxesSize.width]))),P=i.fullChartParams$.pipe(m(o),y(p=>p.highlightTarget),E()),M=he(n,"mousemove").pipe(m(o)),B=T({gridAxesReverseTransform:i.gridAxesReverseTransform$,gridContainerPosition:i.gridContainerPosition$}).pipe(m(o),I(async p=>p),y(p=>{const h=`rotateX(${p.gridAxesReverseTransform.rotateX}deg) rotateY(${p.gridAxesReverseTransform.rotateY}deg)`,S=`rotate(${p.gridAxesReverseTransform.rotate}deg)`,R=`scale(${1/p.gridContainerPosition[0].scale[0]}, ${1/p.gridContainerPosition[0].scale[1]})`;return`${h} ${S} ${R}`}),E()),F=T({textReverseTransform:B,fullParams:i.fullParams$}).pipe(m(o),I(async p=>p),y(p=>`${p.textReverseTransform} rotate(${p.fullParams.labelRotate}deg)`)),x=i.gridContainerPosition$.pipe(m(o),y(p=>p.reduce((S,R)=>R.columnIndex>S?R.columnIndex:S,0)+1),E()),z=i.gridContainerPosition$.pipe(m(o),y(p=>p.reduce((S,R)=>R.rowIndex>S?R.rowIndex:S,0)+1),E()),L=Ke({rootSelection:n,fullDataFormatter$:i.fullDataFormatter$,containerSize$:i.containerSize$,gridAxesContainerSize$:i.gridAxesContainerSize$,computedData$:i.computedData$,gridContainerPosition$:i.gridContainerPosition$,layout$:i.layout$}).pipe(m(o));T({axesSelection:A,columnAmount:x,rowAmount:z,layout:i.layout$,rootMousemove:M,gridGroupPosition:L,computedData:i.computedData$,groupScale:w,gridAxesSize:i.gridAxesSize$,fullParams:i.fullParams$,fullDataFormatter:i.fullDataFormatter$,fullChartParams:i.fullChartParams$,highlightTarget:P,textReverseTransformWithRotate:F,GroupDataMap:i.GroupDataMap$,textSizePx:i.textSizePx$}).pipe(m(o),I(async p=>p)).subscribe(p=>{const{groupIndex:h,groupLabel:S}=p.gridGroupPosition,R=p.groupScale(h)??0,Y=Pt({groupLabel:S,axisX:R,axisHeight:p.gridAxesSize.height,fullParams:p.fullParams});Gt({selection:p.axesSelection,pluginName:t,lineData:Y,fullParams:p.fullParams,fullChartParams:p.fullChartParams});const V=It({groupLabel:S,axisX:R,fullParams:p.fullParams,textSizePx:p.textSizePx,rowAmount:p.rowAmount});Mt({selection:p.axesSelection,labelData:V,fullParams:p.fullParams,fullDataFormatter:p.fullDataFormatter,fullChartParams:p.fullChartParams,textReverseTransformWithRotate:p.textReverseTransformWithRotate,textSizePx:p.textSizePx}).on("mouseover",(k,H)=>{k.stopPropagation(),b=!0,e.event$.next({type:"grid",pluginName:t,eventName:"mouseover",highlightTarget:p.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",group:p.GroupDataMap.get(S)??[],groupIndex:h,groupLabel:S,event:k,data:p.computedData})}).on("mousemove",(k,H)=>{k.stopPropagation(),e.event$.next({type:"grid",pluginName:t,eventName:"mousemove",highlightTarget:p.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",group:p.GroupDataMap.get(S)??[],groupIndex:h,groupLabel:S,event:k,data:p.computedData})}).on("mouseout",(k,H)=>{k.stopPropagation(),b=!1,e.event$.next({type:"grid",pluginName:t,eventName:"mouseout",highlightTarget:p.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",group:p.GroupDataMap.get(S)??[],groupIndex:h,groupLabel:S,event:k,data:p.computedData})}).on("click",(k,H)=>{k.stopPropagation(),e.event$.next({type:"grid",pluginName:t,eventName:"click",highlightTarget:p.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",group:p.GroupDataMap.get(S)??[],groupIndex:h,groupLabel:S,event:k,data:p.computedData})})});const f=he(d,"mouseout").pipe(m(o));return T({rootRectMouseout:f,axesSelection:A}).pipe(m(o),I(async p=>p)).subscribe(p=>{setTimeout(()=>{b!=!0&&(Ct(p.axesSelection),Bt(p.axesSelection))})}),()=>{o.next(void 0),d.remove()}});export{Wt as B,Ot as D,Yt as G,kt as L,Et as S,yt as a,at as b,ut as c,Ft as d,Ht as e};
